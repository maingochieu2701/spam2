<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Facebook Link Masker</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    input, textarea, button { font-size: 16px; margin: 5px 0; width: 100%; }
    .result { max-height: 300px; overflow-y: auto; font-size: 14px; white-space: pre-wrap; border: 1px solid #ccc; padding: 10px; background: #f9f9f9; margin-top: 10px; }
    button.copy { width: auto; margin-top: 10px; }
  </style>
</head>
<body>
  <h2>Facebook Link Masker Tool</h2>
  <label for="links">Link g·ªëc (Facebook) - M·ªói d√≤ng 1 link:</label>
  <textarea id="links" rows="6" placeholder="https://www.facebook.com/..."></textarea>

  <label for="amount">S·ªë l∆∞·ª£ng link mu·ªën t·∫°o cho m·ªói link g·ªëc:</label>
  <input type="number" id="amount" min="1" value="10">

  <button onclick="generateLinks()">T·∫°o link ·∫©n</button>
  <textarea class="result" id="result" readonly></textarea>
  <button class="copy" onclick="copyResult()">üìã Sao ch√©p k·∫øt qu·∫£</button>

  <script>
    function insertRandomZWSP(str) {
      const zwsp = '\u200B';
      const index = Math.floor(Math.random() * (str.length - 1)) + 1;
      return str.slice(0, index) + zwsp + str.slice(index);
    }

    function generateRandomSuffix(length = 10) {
      const chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
      let result = '';
      for (let i = 0; i < length; i++) {
        result += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      return result;
    }

    function generateLinks() {
      const input = document.getElementById('links').value.trim();
      const amount = parseInt(document.getElementById('amount').value);
      const lines = input.split('\n').map(l => l.trim()).filter(l => l.length > 0);

      if (lines.length === 0) {
        alert('Vui l√≤ng nh·∫≠p √≠t nh·∫•t 1 link');
        return;
      }

      if (isNaN(amount) || amount < 1) {
        alert('Vui l√≤ng nh·∫≠p s·ªë l∆∞·ª£ng h·ª£p l·ªá');
        return;
      }

      const result = new Set();

      lines.forEach((original, idx) => {
        if (!original.startsWith('https://www.facebook.com')) {
          console.warn(`Link d√≤ng ${idx + 1} kh√¥ng h·ª£p l·ªá: ${original}`);
          return;
        }

        const match = original.match(/\/posts\/(pfbid\w+)(\?comment_id=\d+)/);
        if (!match) {
          console.warn(`Kh√¥ng t√¨m th·∫•y post_id/comment_id trong d√≤ng ${idx + 1}: ${original}`);
          return;
        }

        const postId = match[1];
        const commentPart = match[2];
        const prefix = original.split(postId)[0];

        let attempts = 0;
        let count = 0;

        while (count < amount && attempts < amount * 20) { // Cho ph√©p nhi·ªÅu l·∫ßn th·ª≠ n·∫øu c√≥ tr√πng
          const modPostId = insertRandomZWSP(postId);
          const suffix = '&' + generateRandomSuffix(10);
          const full = prefix + modPostId + commentPart + suffix;
          if (!result.has(full)) {
            result.add(full);
            count++;
          }
          attempts++;
        }
      });

      if (result.size === 0) {
        document.getElementById('result').value = 'Kh√¥ng c√≥ link n√†o h·ª£p l·ªá ho·∫∑c ƒë∆∞·ª£c t·∫°o.';
      } else {
        document.getElementById('result').value = [...result].join('\n');
      }
    }

    function copyResult() {
      const textarea = document.getElementById('result');
      textarea.select();
      textarea.setSelectionRange(0, 99999);
      document.execCommand('copy');
      alert('ƒê√£ sao ch√©p k·∫øt qu·∫£');
    }
  </script>
</body>
</html>